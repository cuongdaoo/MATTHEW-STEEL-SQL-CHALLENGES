# Challenge 1 - Steve's Car Showroom 

# **Relationship Diagram**
![image](https://github.com/user-attachments/assets/7c86903d-dafa-4945-a40b-2ecbc538f286)
# **Data preview**
Sales table:
\
![image](https://github.com/user-attachments/assets/26fe0820-1b3e-483e-940d-72a060b50dcc)
\
Cars table:
\
![image](https://github.com/user-attachments/assets/88ae9b03-c28a-4741-90d4-5f8f7e8c0681)
\
Saleperson table:
\
![image](https://github.com/user-attachments/assets/003721b8-16ba-49d5-aaff-9ebf87d5d287)
\
# **Solutions**

**1. What are the details of all cars purchased in the year 2022?**

```sql
select * from cars c
join sales s on c.car_id = s.car_id
where year(purchase_date) = 2022
order by c.car_id asc;
```
Output:
\
![image](https://github.com/user-attachments/assets/f3863a5a-a627-4867-82a6-c936f17cfbc0)

**2. What is the total number of cars sold by each salesperson?**

```sql
select sales.salesman_id, salespersons.name, count(car_id) car_amount 
from sales
join salespersons on sales.salesman_id = salespersons.salesman_id
group by sales.salesman_id, salespersons.name
order by car_amount desc;
```
Output:
\
![image](https://github.com/user-attachments/assets/e8dcaea1-18fd-4ff6-b97f-cb2cf508989a)

**3. What is the total revenue generated by each salesperson?**

```sql
select s.salesman_id, name, sum(cost_$) revenue 
from sales s
join cars c on s.car_id = c.car_id
join salespersons on s.salesman_id = salespersons.salesman_id
group by s.salesman_id, name
order by revenue desc;
```
Output:
\
![image](https://github.com/user-attachments/assets/666ce111-b9cd-4146-86b3-256f2890280f)

**4. What are the details of the cars sold by each salesperson?**

```sql
select s.salesman_id, name, c.car_id, make, type, style, cost_$ 
from salespersons sp
join sales s on s.salesman_id = sp.salesman_id
join cars c on c.car_id = s.car_id;
```
Output:
\
![image](https://github.com/user-attachments/assets/2ed97b36-cf04-4067-b427-c7ea952ed549)

**5. What is the total revenue generated by each car type?**

```sql
select c.type, sum(cost_$) revenue 
from sales s
join cars c on s.car_id = c.car_id
group by c.type
order by revenue desc;
```
Output:
\
![image](https://github.com/user-attachments/assets/47053475-ce4b-4d88-afda-636bf7812b39)

**6. What are the details of the cars sold in the year 2021 by salesperson ‘Emily Wong’?**

```sql
select s.salesman_id, sp.name, c.car_id, make, type, style, cost_$ 
from salespersons sp
join sales s on s.salesman_id = sp.salesman_id
join cars c on c.car_id = s.car_id
where sp.name = 'Emily Wong' and year(purchase_date) = 2021;
```
Output:
\
![image](https://github.com/user-attachments/assets/5cc131e4-db33-492a-a3d9-a0765048e2bf)

**7. What is the total revenue generated by the sales of hatchback cars?**

```sql
select c.car_id, sum(cost_$) revenue 
from sales s
join cars c on s.car_id = c.car_id
where style = 'Hatchback'
group by c.car_id;
```
Output:
\
![image](https://github.com/user-attachments/assets/8cb41553-f657-4d89-ba46-c15c7cb37c34)

**8. What is the total revenue generated by the sales of SUV cars in the year 2022?**

```sql
select c.style, sum(cost_$) revenue 
from sales s
join cars c on s.car_id = c.car_id
where style = 'SUV' and year(purchase_date) = 2022
group by c.style;
```
Output:
\
![image](https://github.com/user-attachments/assets/ce6f062c-4d0c-42ff-a8db-50396e969621)

**9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?**

```sql
select top 1 name, city, count(s.car_id) amount 
from salespersons sp
join sales s on s.salesman_id = sp.salesman_id
where year(purchase_date) = 2023
group by name, city
order by amount desc;
```
Output:
\
![image](https://github.com/user-attachments/assets/c2653a71-ab33-49e9-8243-cb20dcea61cf)

**10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?**

```sql
select top 1 name, age, sum(cost_$) revenue 
from salespersons sp
join sales s on s.salesman_id = sp.salesman_id
join cars c on c.car_id = s.car_id
where year(purchase_date) = 2022
group by name, age
order by revenue desc;
```
Output:
\
![image](https://github.com/user-attachments/assets/d00b48c4-0ae6-4064-9419-64997d1b0327)

